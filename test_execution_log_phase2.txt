[1m============================= test session starts =============================[0m
platform win32 -- Python 3.14.3, pytest-9.0.2, pluggy-1.6.0 -- C:\Python314\python.exe
cachedir: .pytest_cache
hypothesis profile 'default'
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: S:\Ryot
plugins: anyio-4.12.1, hypothesis-6.151.4, asyncio-1.3.0, benchmark-5.2.3, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
[1mcollecting ... [0mcollected 23 items

tests/test_training_loop.py::TestTrainingStepCore::test_training_step_output_shapes [32mPASSED[0m[32m [  4%][0m
tests/test_training_loop.py::TestTrainingStepCore::test_loss_computation_correctness [32mPASSED[0m[32m [  8%][0m
tests/test_training_loop.py::TestTrainingStepCore::test_grayscale_to_rgb_handling [32mPASSED[0m[32m [ 13%][0m
tests/test_training_loop.py::TestTrainingStepCore::test_batch_normalization_forward_backward [32mPASSED[0m[32m [ 17%][0m
tests/test_training_loop.py::TestTrainingStepCore::test_gradient_accumulation [32mPASSED[0m[32m [ 21%][0m
tests/test_training_loop.py::TestMetricsCollection::test_loss_history_tracking [32mPASSED[0m[32m [ 26%][0m
tests/test_training_loop.py::TestMetricsCollection::test_accuracy_computation [32mPASSED[0m[32m [ 30%][0m
tests/test_training_loop.py::TestMetricsCollection::test_throughput_measurement [32mPASSED[0m[32m [ 34%][0m
tests/test_training_loop.py::TestMetricsCollection::test_memory_tracking [32mPASSED[0m[32m [ 39%][0m
tests/test_training_loop.py::TestMetricsCollection::test_metrics_nan_handling [32mPASSED[0m[32m [ 43%][0m
tests/test_training_loop.py::TestOptimizationControllerIntegration::test_kernel_optimizer_detection [32mPASSED[0m[32m [ 47%][0m
tests/test_training_loop.py::TestOptimizationControllerIntegration::test_compression_encoding [32mPASSED[0m[32m [ 52%][0m
tests/test_training_loop.py::TestOptimizationControllerIntegration::test_compression_decoding [32mPASSED[0m[32m [ 56%][0m
tests/test_training_loop.py::TestOptimizationControllerIntegration::test_inference_scaling_kv_cache [32mPASSED[0m[32m [ 60%][0m
tests/test_training_loop.py::TestOptimizationControllerIntegration::test_rlvr_training_loop [32mPASSED[0m[32m [ 65%][0m
tests/test_training_loop.py::TestConfigurationLoading::test_load_unified_config [32mPASSED[0m[32m [ 69%][0m
tests/test_training_loop.py::TestConfigurationLoading::test_config_validation [32mPASSED[0m[32m [ 73%][0m
tests/test_training_loop.py::TestConfigurationLoading::test_default_parameter_values [32mPASSED[0m[32m [ 78%][0m
tests/test_training_loop.py::TestConfigurationLoading::test_optimization_precedence [32mPASSED[0m[32m [ 82%][0m
tests/test_training_loop.py::TestGradientFlow::test_gradients_non_zero [32mPASSED[0m[32m [ 86%][0m
tests/test_training_loop.py::TestGradientFlow::test_no_gradient_explosion [32mPASSED[0m[32m [ 91%][0m
tests/test_training_loop.py::TestGradientFlow::test_no_gradient_vanishing [31mFAILED[0m[31m [ 95%][0m
tests/test_training_loop.py::TestGradientFlow::test_gradient_norm_consistency [32mPASSED[0m[31m [100%][0m

================================== FAILURES ===================================
[31m[1m_________________ TestGradientFlow.test_no_gradient_vanishing _________________[0m
[1m[31mtests\test_training_loop.py[0m:662: in test_no_gradient_vanishing
    [0m[94massert[39;49;00m min_grad > [94m1e-7[39;49;00m, [33mf[39;49;00m[33m"[39;49;00m[33mGradient vanishing detected: min_grad = [39;49;00m[33m{[39;49;00mmin_grad[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
[1m[31mE   AssertionError: Gradient vanishing detected: min_grad = 0.0[0m
[1m[31mE   assert 0.0 > 1e-07[0m
[36m[1m=========================== short test summary info ===========================[0m
[31mFAILED[0m tests/test_training_loop.py::[1mTestGradientFlow::test_no_gradient_vanishing[0m - AssertionError: Gradient vanishing detected: min_grad = 0.0
[31m======================== [31m[1m1 failed[0m, [32m22 passed[0m[31m in 10.22s[0m[31m ========================[0m
